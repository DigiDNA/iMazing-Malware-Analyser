/*******************************************************************************
 * Copyright (c) 2021, DigiDNA
 * All rights reserved
 *
 * This Source Code Form is subject to the terms of the MVT License, v. 1.1.
 * If a copy of the MVT License was not distributed with this file, you can
 * obtain one at https://license.mvt.re/1.1/.
 ******************************************************************************/

#ifndef DDNA_MALWARE_CHECK_OPERA_HISTORY_HPP
#define DDNA_MALWARE_CHECK_OPERA_HISTORY_HPP

#include <DDNAToolKit/C++/MobileDevice/Diagnostics/MalwareActivityChecker/DDNA-MalwareCheck.hpp>

namespace DDNA
{
    namespace MalwareChecks
    {
        class OperaHistory: public MalwareCheck
        {
            public:
                
                std::string name( void ) const override;
                std::string image( void ) const override;
                std::vector< iOSDataset > iOSDatasets( void ) const override;
                void run( Core::SafePointer< Backup > backup, const STIXIndicators & indicators, std::vector< MalwareCheckResult > & results, Core::Progress & progress ) override;
                void analyzeIcons( sqlite3 * db, const STIXIndicators & indicators, std::vector< MalwareCheckResult > & results );
                void analyzeSites( sqlite3 * db, const STIXIndicators & indicators, std::vector< MalwareCheckResult > & results );
                void analyzeTabs( sqlite3 * db, const STIXIndicators & indicators, std::vector< MalwareCheckResult > & results );
                void analyzeURLs( sqlite3 * db, const STIXIndicators & indicators, std::vector< MalwareCheckResult > & results );
        };
    }
}

#endif /* DDNA_MALWARE_CHECK_OPERA_HISTORY_HPP */
