/*******************************************************************************
 * Copyright (c) 2021, DigiDNA
 * All rights reserved
 *
 * This Source Code Form is subject to the terms of the MVT License, v. 1.1.
 * If a copy of the MVT License was not distributed with this file, you can
 * obtain one at https://license.mvt.re/1.1/.
 ******************************************************************************/

#ifndef DDNA_MALWARE_ACTIVITY_DETECTION_OPERATION_H
#define DDNA_MALWARE_ACTIVITY_DETECTION_OPERATION_H

#include <DDNA/Core.hpp>
#include <CF++.hpp>

namespace DDNA
{
    class iOSDevice;

    /*!
     * @class           DDNA::MalwareActivityDetectionOperation
     * @abstract        ...
     * @description     ...
     */
    class MalwareActivityDetectionOperation: public Core::Operation
    {
        public:
            static const char * const ErrorDomain;
        
            DDNA_PROPERTY_READONLY( Core::SafePointer< iOSDevice >, device )
            DDNA_PROPERTY_READONLY( std::string,                    stixFolderPath )
            DDNA_PROPERTY_READONLY( std::string,                    logPath )
            DDNA_PROPERTY_READONLY( bool,                           logAsExcel )

            MalwareActivityDetectionOperation( Core::SafePointer< iOSDevice > device, bool backupDevice, const std::string & stixFolderPath, const std::string & logPath, bool logAsExcel );

        protected:
            bool _execute( void ) override;
        
        private:
            Core::SafePointer< Operation > _subOperation;
    };
}
#endif /* DDNA_MALWARE_ACTIVITY_DETECTION_OPERATION_H */
