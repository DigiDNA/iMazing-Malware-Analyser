/*******************************************************************************
 * Copyright (c) 2021, DigiDNA
 * All rights reserved
 *
 * This Source Code Form is subject to the terms of the MVT License, v. 1.1.
 * If a copy of the MVT License was not distributed with this file, you can
 * obtain one at https://license.mvt.re/1.1/.
 ******************************************************************************/

#ifndef DDNA_MALWARE_CHECK_HPP
#define DDNA_MALWARE_CHECK_HPP

#include <vector>
#include <DDNA/Core.hpp>
#include <DDNAToolKit/C++/MobileDevice/Backups/DDNA-Backup.hpp>
#include <DDNAToolKit/C++/MobileDevice/Diagnostics/MalwareActivityChecker/DDNA-MalwareCheckResult.hpp>
#include <DDNAToolKit/C++/MobileDevice/Diagnostics/MalwareActivityChecker/DDNA-STIXIndicators.hpp>

namespace DDNA
{
    class MalwareCheck: public Core::Object
    {
        public:
            
            static Core::ObjectVector< MalwareCheck * > allChecks();
            
            virtual ~MalwareCheck() = default;
            
            virtual std::string name()  const = 0;
            virtual std::string image() const = 0;
            virtual void run( Core::SafePointer< Backup > backup, const STIXIndicators & indicators, std::vector< MalwareCheckResult > & results, Core::Progress & progress ) = 0;
    };
}

#endif /* DDNA_MALWARE_CHECK_HPP */
